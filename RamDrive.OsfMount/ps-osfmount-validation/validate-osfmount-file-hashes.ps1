$rightHashes = @{
  'osfdisk.cat'='6EA379D156569BF9287812B276D9C8A704CEE40D016735B703E8E0AD754BF4AE6ADEEB9C06A8802A7FDF27370440331F57F8725834A59E9084C6059552974C78';
  'osfdisk.inf'='9318FBA61ACDB6C065B955D68EE26DCD38935A8779E79F92160BADEBBC6489267CAC33E19C57BD217AB316F067EC93CFC8F0792CDE6CE2AFF83144A50A143498';
  'osfdisk.sys'='F52E64B685CE4D3866817A0507B9CFEBDF6042F5563E702B19B79C8D5D1B22E5E2D045DD471480FB39D3D6FBF63991882FFD9F826C761EE28EB1168B5E05FA54';
  'OSFMount.com'='C3F29FE068D91C0C34D6470D5F16B14B4A2352598D16EFED086A9D520839B7EC2C9A9D3C8C52341A09CE0D0395B9648E76FC42494BDF539225895B6816841521';
  'OSFMount.sys'='8D520F1511284B16DFBEC8DBAE86AAD2A5F955762BFE0D0D315AB077BC0285A979D8385D12287BDD540191BD6BB29EED9DFD15FF9CBDEE505094DB2AB45B93AC';
  'win10\osfdisk.cat'='952F6752E0F8C60F18EE842A7F06B88EB110A0B6DB51E031C04445EE4357E84BA564467657C4F7C0384B84A686F16789BD13FA413EB8FA8C0EAB75B250DCC974';
  'win10\osfdisk.inf'='9318FBA61ACDB6C065B955D68EE26DCD38935A8779E79F92160BADEBBC6489267CAC33E19C57BD217AB316F067EC93CFC8F0792CDE6CE2AFF83144A50A143498';
  'win10\osfdisk.sys'='13993ADFCEDA082297815FD0AF0625ECB1B42DAF4CF4E4CE69AFAD40C9B807DC4EB54C359C6AE4BDA3C661C0D01A7D79FE9BBA7581DD807AB332A93417E06E2E';
  'win10\OSFMount.sys'='745388C168E21545A8CE371C46671A5A55F767ED693C52C7CF7CCD6FC6C985E21709CE00C7E19CE7AB684E0E9A17A04AB095FAD98E349E0001731002199ABCE7';
};

$allOsfMountFilesPath = (Get-Item $PSScriptRoot).Parent.FullName + '\osfmount-bin\'
$allOsfMountFiles = Get-ChildItem -Path $allOsfMountFilesPath -recurse -Attributes !Directory
if (-not ($allOsfMountFiles.Length -eq $rightHashes.Count)) {
  throw 'Not all files validated by script.'
}
$allOsfMountFiles | ForEach-Object {
  $fullFilePath = $_.FullName
  $file = $_.FullName.Replace($allOsfMountFilesPath, '')
  $fileHash = Get-FileHash $fullFilePath -Algorithm SHA512

  if (-not ($fileHash.Hash -eq $rightHashes[$file]))
  {
    'File {0} is fake: expected and actual hashes are not equal' -f $file | Write-Error
    throw 'File {0} is fake: expected and actual hashes are not equal' -f $file
  }
}